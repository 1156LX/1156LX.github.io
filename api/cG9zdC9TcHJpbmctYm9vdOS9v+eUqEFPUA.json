{"title":"spring boot使用AOP","date":"2018-11-07T02:46:13.538Z","slug":"Spring-boot使用AOP","updated":"2018-11-07T02:48:47.748Z","content":"<h1 id=\"AOP开发流程\"><a href=\"#AOP开发流程\" class=\"headerlink\" title=\"AOP开发流程\"></a>AOP开发流程</h1><ul>\n<li><p>1.spring-boot-starter-aop,加入依赖，默认开启了AOP的支持</p>\n</li>\n<li><p>2.写一个Aspect,封装横切关注点（日志，监控等等），需要配置通知（前置通知，后置通知等等）和切入点（哪些包下的哪些类的哪些方法）</p>\n</li>\n<li><p>3.这个Aspect需要纳入到spring容器管理中，并且需要加@Aspect</p>\n</li>\n</ul>\n<h2 id=\"简单demo\"><a href=\"#简单demo\" class=\"headerlink\" title=\"简单demo\"></a>简单demo</h2><p>结构<br><img src=\"https://img-blog.csdnimg.cn/20181107103048249.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xYMzMzWEw=,size_16,color_FFFFFF,t_70\" alt=\"在这里插入图片描述\"></p>\n<p> 加入aop依赖<br> <figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> &lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;org.springframework.boot&lt;<span class=\"regexp\">/groupId&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">    &lt;artifactId&gt;spring-boot-starter-aop&lt;/</span>artifactId&gt;</span><br><span class=\"line\">&lt;<span class=\"regexp\">/dependency&gt;</span></span><br></pre></td></tr></table></figure></p>\n<p>dao类：UserDao<br> <figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> package com.lixin.aop.dao;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.stereotype.Component;</span><br><span class=\"line\"></span><br><span class=\"line\">@Component <span class=\"comment\">//Bean的注入</span></span><br><span class=\"line\">public <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">UserDao</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    public <span class=\"keyword\">void</span> add(<span class=\"built_in\">String</span> username,<span class=\"built_in\">String</span> password)&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"add[username: \"</span>+username+<span class=\"string\">\", password: \"</span>+password+<span class=\"string\">\"]\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>aspect类：LogAspect<br> <figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> package com.lixin.aop.aspect;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.aspectj.lang.annotation.Before;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.stereotype.Component;</span><br><span class=\"line\"></span><br><span class=\"line\">@Aspect</span><br><span class=\"line\">@Component</span><br><span class=\"line\">public <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">LogAspect</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Before(<span class=\"string\">\"execution(* com.lixin.aop.dao..*.*(..))\"</span>)<span class=\"comment\">//方法执行前调用，前置通知</span></span><br><span class=\"line\">    public <span class=\"keyword\">void</span> log()&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"开始记录日志。。。\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>app<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@SpringBootApplication</span><br><span class=\"line\">public <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AopApplication</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    public <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> main(<span class=\"built_in\">String</span>[] args) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">       ConfigurableApplicationContext context =SpringApplication.run(AopApplication.class, args);</span><br><span class=\"line\">       context.getBean(UserDao.class).add(<span class=\"string\">\"李鑫\"</span>,<span class=\"string\">\"123456\"</span>);</span><br><span class=\"line\">       context.close();</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>注：spring.aop.auto配置决定是否启动AOP，默认启动</p>\n","next":{"title":"spring boot集成mybatis--xml配置","slug":"spring boot集成mybatis--xml配置"},"link":"http://starlx.cn/post/Spring-boot使用AOP/","toc":[{"title":"AOP开发流程","id":"AOP开发流程","index":"1","children":[{"title":"简单demo","id":"简单demo","index":"1.1"}]}]}