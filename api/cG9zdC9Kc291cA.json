{"title":"Jsoup","date":"2018-12-15T01:58:33.000Z","slug":"Jsoup","updated":"2018-12-15T02:00:12.237Z","content":"<p><strong>一.简介</strong></p>\n<p>   jsoup 是一款Java 的HTML解析器，可直接解析某个URL地址、HTML文本内容。它提供了一套非常省力的API，可通过DOM，CSS以及类似于jQuery的操作方法来取出和操作数据。</p>\n<p><strong>二.主要功能</strong><br>    1）从一个URL，文件或字符串中解析HTML<br>    2）使用DOM或CSS选择器来查找、取出数据<br>    3）可操作HTML元素、属性、文本</p>\n<p><strong>需要加入的依赖</strong><br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;org.jsoup&lt;<span class=\"regexp\">/groupId&gt; </span></span><br><span class=\"line\"><span class=\"regexp\">    &lt;artifactId&gt;jsoup&lt;/</span>artifactId&gt;        </span><br><span class=\"line\">    &lt;version&gt;<span class=\"number\">1.10</span><span class=\"number\">.2</span>&lt;<span class=\"regexp\">/version&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">&lt;/</span>dependency&gt;</span><br></pre></td></tr></table></figure></p>\n<p><strong>1).Jsoup查找DOM元素</strong></p>\n<p>Jsoup提供了丰富的API来给我们查找我们需要的DOM元素；</p>\n<p>这里例举一些常用的：</p>\n<p>getElementById(String id) 根据id来查询</p>\n<p>getElementsByTag(String tagName) 根据tag名称查询</p>\n<p>getElementsByClass(String className) 根据样式名称来查询</p>\n<p>getElementsByAttribute(String key) 根据属性名来查询</p>\n<p>getElementsByAttributeValue(String key,String value)  根据属性名和属性值来查询<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.lixin.jsoup;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> org.jsoup.Jsoup;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.jsoup.nodes.Element;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.jsoup.select.Elements;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">test1</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\">        String url=<span class=\"string\">\"https://www.cnblogs.com/\"</span>;</span><br><span class=\"line\">        org.jsoup.nodes.Document doc=Jsoup.connect(url).get();<span class=\"comment\">//解析网页，得到文本对象</span></span><br><span class=\"line\">        System.out.println(doc);</span><br><span class=\"line\"></span><br><span class=\"line\">        Element navTopElement=doc.getElementById(<span class=\"string\">\"site_nav_top\"</span>); <span class=\"comment\">// 根据id来查询DOM</span></span><br><span class=\"line\">        String navTop=navTopElement.text(); <span class=\"comment\">// 返回元素的文本</span></span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"口号：\"</span>+navTop);</span><br><span class=\"line\"></span><br><span class=\"line\">        Elements titleElements=doc.getElementsByTag(<span class=\"string\">\"title\"</span>); <span class=\"comment\">// 根据tag名称来查询DOM</span></span><br><span class=\"line\">        Element titleElement=titleElements.get(<span class=\"number\">0</span>); <span class=\"comment\">// 获取第1个元素</span></span><br><span class=\"line\">        String title=titleElement.text(); <span class=\"comment\">// 返回元素的文本</span></span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"网页标题是：\"</span>+title);</span><br><span class=\"line\"></span><br><span class=\"line\">        Elements postItemElements=doc.getElementsByClass(<span class=\"string\">\"post_item \"</span>); <span class=\"comment\">// 根据样式名称来查询DOM</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span>(Element e:postItemElements)&#123;</span><br><span class=\"line\">            System.out.println(e.html());</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"================\"</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        Elements widthElements=doc.getElementsByAttribute(<span class=\"string\">\"width\"</span>); <span class=\"comment\">// 根据属性名来查询DOM</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span>(Element e:widthElements)&#123;</span><br><span class=\"line\">            System.out.println(e.toString());</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"================\"</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"target-_blank\"</span>);</span><br><span class=\"line\">        Elements targetElements=doc.getElementsByAttributeValue(<span class=\"string\">\"target\"</span>, <span class=\"string\">\"_blank\"</span>);  <span class=\"comment\">// 根据属性名和属性值来查询DOM</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span>(Element e:targetElements)&#123;</span><br><span class=\"line\">            System.out.println(e.toString());</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"================\"</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><strong>2).使用选择器语法查找DOM元素</strong></p>\n<p>通过标签名，Id，Class样式等来搜索DOM，这些是不能满足实际开发需求的，很多时候我们需要寻找有规律的DOM集合，很多个有规律的标签层次；这时候，选择器就用上了 css jquery都有，Jsoup支持css,jquery类似的选择器语法；<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package com.lixin.jsoup;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> org.jsoup.Jsoup;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.jsoup.nodes.Element;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.jsoup.select.Elements;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException;</span><br><span class=\"line\"></span><br><span class=\"line\">public <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">test2</span> </span>&#123;</span><br><span class=\"line\">    public <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> main(<span class=\"built_in\">String</span>[] args) throws IOException &#123;</span><br><span class=\"line\">        <span class=\"built_in\">String</span> url=<span class=\"string\">\"https://www.cnblogs.com/\"</span>;</span><br><span class=\"line\">        org.jsoup.nodes.Document doc=Jsoup.connect(url).get();<span class=\"comment\">//解析网页，得到文本对象</span></span><br><span class=\"line\">        System.out.println(doc);</span><br><span class=\"line\"></span><br><span class=\"line\">        Elements linkElements=doc.select(<span class=\"string\">\".post_item .post_item_body h3 a\"</span>); <span class=\"comment\">// 查找所有帖子DOM</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span>(Element e:linkElements)&#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"博客标题：\"</span>+e.text());</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"-------------\"</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        Elements hrefElements=doc.select(<span class=\"string\">\"a[href]\"</span>); <span class=\"comment\">// 带有href属性的a元素</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span>(Element e:hrefElements)&#123;</span><br><span class=\"line\">            System.out.println(e.toString());</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"-------------\"</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        Elements imgElements=doc.select(<span class=\"string\">\"img[src$=.png]\"</span>); <span class=\"comment\">// 查找扩展名为.png的图片DOM节点</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span>(Element e:imgElements)&#123;</span><br><span class=\"line\">            System.out.println(e.toString());</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"-------------\"</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        Element element=doc.getElementsByTag(<span class=\"string\">\"title\"</span>).first(); <span class=\"comment\">// 获取tag是title的所有DOM元素</span></span><br><span class=\"line\">        <span class=\"built_in\">String</span> title=element.text(); <span class=\"comment\">// 返回元素的文本</span></span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"网页标题是：\"</span>+title);</span><br><span class=\"line\">    </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><strong>3).获取DOM元素属性值</strong></p>\n<p>比如我们要获取博客的href属性值：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package com.lixin.jsoup;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> org.jsoup.Jsoup;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.jsoup.nodes.Element;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.jsoup.select.Elements;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException;</span><br><span class=\"line\"></span><br><span class=\"line\">public <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">test3</span> </span>&#123;</span><br><span class=\"line\">    public <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> main(<span class=\"built_in\">String</span>[] args) throws IOException &#123;</span><br><span class=\"line\">        <span class=\"built_in\">String</span> url = <span class=\"string\">\"https://www.cnblogs.com/\"</span>;</span><br><span class=\"line\">        org.jsoup.nodes.Document doc = Jsoup.connect(url).get();<span class=\"comment\">//解析网页，得到文本对象</span></span><br><span class=\"line\">        <span class=\"comment\">//System.out.println(doc);</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">        Elements linkElements=doc.select(<span class=\"string\">\"#post_list .post_item .post_item_body h3 a\"</span>); <span class=\"comment\">//通过选择器查找所有博客链接DOM</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span>(Element e:linkElements)&#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"博客标题：\"</span>+e.text());</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"博客地址：\"</span>+e.attr(<span class=\"string\">\"href\"</span>));</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"target:\"</span>+e.attr(<span class=\"string\">\"target\"</span>));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        Element linkElement=doc.select(<span class=\"string\">\"#friend_link\"</span>).first();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"纯文本：\"</span>+linkElement.text());</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"html：\"</span>+linkElement.html());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","next":{"title":"c++中map用法","slug":"c-中map用法"},"link":"http://starlx.cn/post/Jsoup/"}